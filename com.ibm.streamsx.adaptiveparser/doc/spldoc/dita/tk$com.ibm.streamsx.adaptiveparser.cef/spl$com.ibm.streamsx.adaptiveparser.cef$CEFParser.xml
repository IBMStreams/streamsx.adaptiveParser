<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="spldoc_compilationunit">
<title>SPL File <tt>CEFParser.spl</tt></title>
<refbody>
<section>
<p>
<xref href="../toolkits/toolkits.xml">Toolkits</xref> &gt; <xref href="tk$com.ibm.streamsx.adaptiveparser.cef.xml">com.ibm.streamsx.adaptiveparser.cef 2.1</xref> &gt; <xref href="ns$com.ibm.streamsx.adaptiveparser.cef.xml">com.ibm.streamsx.adaptiveparser.cef</xref> &gt; CEFParser.spl</p>
</section>
<section>
  <title outputclass="splhead-1">Content</title>
  <dl>
    <dlentry><dt></dt><dd></dd></dlentry>
    <dlentry>
      <dt outputclass="splhead-2">Operators</dt>
      <dd>
<sl>
<sli><b><xref href="spl$com.ibm.streamsx.adaptiveparser.cef$CEFParser.xml#spldoc_compilationunit/composite_operator__CEFParser">CEFParser</xref></b>
</sli>
</sl>
      </dd>
    </dlentry>
    <dlentry>
      <dt outputclass="splhead-2">Types</dt>
      <dd>
<sl>
<sli><b><xref href="spl$com.ibm.streamsx.adaptiveparser.cef$CEFParser.xml#spldoc_compilationunit/composite_type__CEFParser.CEFExtension_t">CEFParser.CEFExtension_t</xref></b>
</sli>
<sli><b><xref href="spl$com.ibm.streamsx.adaptiveparser.cef$CEFParser.xml#spldoc_compilationunit/composite_type__CEFParser.CEFHeader_t">CEFParser.CEFHeader_t</xref></b>
</sli>
<sli><b><xref href="spl$com.ibm.streamsx.adaptiveparser.cef$CEFParser.xml#spldoc_compilationunit/composite_type__CEFParser.CEFSeverity_e">CEFParser.CEFSeverity_e</xref></b>
</sli>
</sl>
      </dd>
    </dlentry>
  </dl>
</section>
<section>
  <title outputclass="splhead-1">Composites</title>
</section>
<section id="composite_operator__CEFParser">
  <title outputclass="splpart">composite CEFParser(output CEFEvent; input RawData)</title>
</section>
<section outputclass="splgraph">
  <image href="../../image/tk$com.ibm.streamsx.adaptiveparser.cef/op$com.ibm.streamsx.adaptiveparser.cef$CEFParser.svg" width="142" height="109">
    <alt>SPL composite operator image not displayed. Problem loading file: ../../image/tk$com.ibm.streamsx.adaptiveparser.cef/op$com.ibm.streamsx.adaptiveparser.cef$CEFParser.svg
</alt>
  </image>
</section>
<section>
<title>Parameters</title>
<sl>
<sli><b>dataAttr</b>
</sli>
<sli><b>batch</b>
</sli>
</sl>
</section>
<section>
<title>Input Ports</title>
<sl>
<sli><b>RawData</b>
</sli>
</sl>
</section>
<section>
<title>Output Ports</title>
<sl>
<sli><b>CEFEvent</b>
</sli>
</sl>
</section>
<section>
  <title>Static Types</title>
</section>
   <section id="composite_type__CEFParser.CEFExtension_t">
     <dl>
       <dlentry>
         <dt>CEFParser.CEFExtension_t = map&lt;rstring, rstring&gt; properties;</dt>
         <dd></dd>
       </dlentry>
     </dl>
   </section>
   <section id="composite_type__CEFParser.CEFHeader_t">
     <dl>
       <dlentry>
         <dt>CEFParser.CEFHeader_t = uint16 version, rstring deviceVendor, rstring deviceProduct, rstring deviceVersion, rstring signatureID, rstring name, CEFParser.CEFSeverity_e severity;</dt>
         <dd></dd>
       </dlentry>
     </dl>
   </section>
   <section id="composite_type__CEFParser.CEFSeverity_e">
     <dl>
       <dlentry>
         <dt>CEFParser.CEFSeverity_e = enum { Low, Medium, High, VeryHigh, Unknown };</dt>
         <dd></dd>
       </dlentry>
     </dl>
   </section>
<section>
  <title outputclass="splhead-2">SPL Source Code</title>
</section>

<section>
   <codeblock>
<![CDATA[
 public composite CEFParser(input RawData; output CEFEvent) {
 param
 	attribute $dataAttr;
 	expression<boolean> $batch : false;
 
 type
 	static CEFSeverity_e	=	enum {Low, Medium, High, VeryHigh, Unknown};
 	
 	static CEFHeader_t		= 	uint16 version,
 								rstring deviceVendor,
 								rstring deviceProduct,
 								rstring deviceVersion, 
 								rstring signatureID, 
 								rstring name, 
 								CEFParser.CEFSeverity_e severity;
 
 	static CEFExtension_t	=	map<rstring,rstring> properties;
 	
 graph
     
     stream<CEFParser.CEFHeader_t, CEFParser.CEFExtension_t> CEFEvent = AdaptiveParser(RawData) {
     	param
     		batch : $batch;
     		dataAttr : $dataAttr;
     		globalDelimiter : "|";
     		globalEscapeChar : "\\";
 		output
 			CEFEvent :
 				version = Param({prefix = "CEF:"}),
 				severity = Param({enumAliasesMap = {"Very-High" : "VeryHigh"}}),
 				properties = Param( {cutStringDelim = "CEF:", delimiter = "", globalDelimiter = "", globalEscapeChar = ""},
 					  				{key = ParamN({delimiter = "="}), value = ParamN({cutCharsetDelim = "a-zA-Z0-9_.)(-"})});
     }
 }
]]>
   </codeblock>
</section>
</refbody>
</reference>

